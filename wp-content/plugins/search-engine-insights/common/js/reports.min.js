"use strict";if(seiwpItemData.mapsApiKey){google.charts.load("current",{mapsApiKey:seiwpItemData.mapsApiKey,packages:["corechart","table","orgchart","geochart","controls"]})}else{google.charts.load("current",{packages:["corechart","table","orgchart","geochart","controls"]})}google.charts.setOnLoadCallback(SEIWPReportLoad);seiwpItemData.getID=function(a){if(seiwpItemData.scope=="admin-item"){if(typeof a.id=="undefined"){return 0}if(a.id.split("-")[1]=="undefined"){return 0}else{return a.id.split("-")[1]}}else{if(typeof a.id=="undefined"){return 1}if(a.id.split("-")[4]=="undefined"){return 1}else{return a.id.split("-")[4]}}};seiwpItemData.getSelector=function(a){if(a=="admin-item"){return'a[id^="seiwp-"]'}else{return'li[id^="wp-admin-bar-seiwp"] a'}};seiwpItemData.responsiveDialog=function(){var b,a,c;c=jQuery(".ui-dialog:visible");c.each(function(){b=jQuery(this).find(".ui-dialog-content").data("ui-dialog");if(b.options.fluid){a=jQuery(window).width();if(a<(parseInt(b.options.maxWidth)+50)){jQuery(this).css("max-width","90%")}else{jQuery(this).css("max-width",b.options.maxWidth+"px")}b.option("position",b.options.position)}})};jQuery.fn.extend({seiwpItemReport:function(g){var a,d,h,e,f,i,c,b="-"+g;d={setCookie:function(k,m){var j,l=new Date();if(seiwpItemData.scope=="admin-widgets"){k="seiwp_wg_"+k}else{k="seiwp_ir_"+k}l.setTime(l.getTime()+(24*60*60*1000*365));j="expires="+l.toUTCString();document.cookie=k+"="+m+"; "+j+"; path=/"},getCookie:function(j){var l,m,n,k=0;if(seiwpItemData.scope=="admin-widgets"){j="seiwp_wg_"+j+"="}else{j="seiwp_ir_"+j+"="}m=document.cookie.split(";");for(k=0;k<m.length;k++){l=m[k];while(l.charAt(0)==" "){l=l.substring(1)}if(l.indexOf(j)==0){return l.substring(j.length,l.length)}}return false},escape:function(j){div=document.createElement("div");div.appendChild(document.createTextNode(j));return div.innerHTML}};h={addOptions:function(o,n){var j,l,m,k=[];if(!d.getCookie("default_metric")||!d.getCookie("default_dimension")||!d.getCookie("default_swmetric")){j="sessions";l=moment().subtract(30,"days").format("YYYY-MM-DD")+" - "+moment().subtract(1,"days").format("YYYY-MM-DD");c="impressions";d.setCookie("default_metric",j);d.setCookie("default_dimension",l);d.setCookie("default_swmetric",c)}else{j=d.getCookie("default_metric");l=d.getCookie("default_dimension");m=d.getCookie("default_view");c=d.getCookie("default_swmetric")}if(n=="submetrics"){k='<span id="seiwp-swmetric-impressions" title="'+seiwpItemData.i18n[5]+'" class="dashicons dashicons-visibility" style="font-size:22px;padding:7px 4px;"></span>';k+='<span id="seiwp-swmetric-clicks" title="'+seiwpItemData.i18n[6]+'" class="dashicons dashicons-external" style="font-size:22px;padding:7px 4px;"></span>';k+='<span id="seiwp-swmetric-position" title="'+seiwpItemData.i18n[7]+'" class="dashicons dashicons-layout" style="font-size:22px;padding:7px 4px;"></span>';k+='<span id="seiwp-swmetric-ctr" title="'+seiwpItemData.i18n[8]+'" class="dashicons dashicons-performance" style="font-size:22px;padding:7px 4px;"></span>';jQuery(o).html(k);jQuery("#seiwp-swmetric-"+c).css("color","#008ec2")}else{if(n=="range"){jQuery(o).val(l)}else{jQuery.each(n,function(p,q){if(p==j||p==l||p==m){k.push('<option value="'+p+'" selected="selected">'+q+"</option>")}else{k.push('<option value="'+p+'">'+q+"</option>")}});jQuery(o).html(k.join(""))}}},init:function(){var j;if(!jQuery("#seiwp-window"+b).length){return}if(jQuery("#seiwp-window"+b).html().length){return}j='<div id="seiwp-container'+b+'">';if(seiwpItemData.propertyList!=false){j+='<select id="seiwp-sel-property'+b+'"></select>'}j+='<input type="text" id="seiwp-sel-period'+b+'" name="seiwp-sel-period'+b+'" size="21"/>';j+='<select id="seiwp-sel-report'+b+'"></select>';j+='<div id="seiwp-sel-metric'+b+'" style="float:right;display:none;">';j+="</div>";j+='<div id="seiwp-progressbar'+b+'"></div>';j+='<div id="seiwp-status'+b+'"></div>';j+='<div id="seiwp-reports'+b+'"></div>';j+='<div style="text-align:right;width:100%;font-size:0.8em;clear:both;margin-right:5px;margin-top:10px;">';j+=seiwpItemData.i18n[14];j+=' <a href="https://deconf.com/search-engine-insights/" rel="nofollow" style="text-decoration:none;font-size:1em;color:#0073aa;">Search Engine Insights</a>&nbsp;';j+="</div>";j+="</div>",jQuery("#seiwp-window"+b).append(j);h.addOptions("#seiwp-sel-period"+b,"range");h.addOptions("#seiwp-sel-property"+b,seiwpItemData.propertyList);h.addOptions("#seiwp-sel-report"+b,seiwpItemData.reportList);h.addOptions("#seiwp-sel-metric"+b,"submetrics")}};e={oldViewPort:0,orgChartTableChartData:"",tableChartData:"",orgChartPieChartsData:"",geoChartTableChartData:"",areachartSummaryData:"",rtRuns:null,i18n:null,getTitle:function(j){if(j=="admin-item"){return jQuery("#seiwp"+b).attr("title")}else{return document.getElementsByTagName("title")[0].innerHTML}},alertMessage:function(j){jQuery("#seiwp-status"+b).css({"margin-top":"3px","padding-left":"5px",height:"auto",color:"#000","border-left":"5px solid red"});jQuery("#seiwp-status"+b).html(j)},areachartSummary:function(j){var k;jQuery("#seiwp-sel-metric"+b).hide();k='<div id="seiwp-areachartsummary'+b+'">';k+='<div id="seiwp-summary'+b+'">';k+='<div class="inside">';k+='<div class="small-box first"><h3>'+seiwpItemData.i18n[5]+'</h3><p id="seiwpimpressions'+b+'">&nbsp;</p></div>';k+='<div class="small-box second"><h3>'+seiwpItemData.i18n[6]+'</h3><p id="seiwpclicks'+b+'">&nbsp;</p></div>';k+='<div class="small-box third"><h3>'+seiwpItemData.i18n[7]+'</h3><p id="seiwpposition'+b+'">&nbsp;</p></div>';k+='<div class="small-box last"><h3>'+seiwpItemData.i18n[8]+'</h3><p id="seiwpctr'+b+'">&nbsp;</p></div>';k+="</div>";k+='<div id="seiwp-areachart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#seiwp-areachartsummary"+b).length){jQuery("#seiwp-reports"+b).html(k)}e.areachartSummaryData=j;if(jQuery.isArray(j)){if(!jQuery.isNumeric(j[0])){if(jQuery.isArray(j[0])){if(a.query=="visitBounceRate,summary"){e.drawareachart(j[0],true)}else{e.drawareachart(j[0],false)}}else{e.throwDebug(j[0])}}else{e.throwError("#seiwp-areachart"+b,j[0],"125px")}if(!jQuery.isNumeric(j[1])){if(jQuery.isArray(j[1])){e.drawSummary(j[1])}else{e.throwDebug(j[1])}}else{e.throwError("#seiwp-summary"+b,j[1],"40px")}}else{e.throwDebug(j)}SEIWPNProgress.done()},orgChartPieCharts:function(j){var l=0;var k;k='<div id="seiwp-orgchartpiecharts'+b+'">';k+='<div id="seiwp-orgchart'+b+'"></div>';k+='<div class="seiwp-floatwraper">';k+='<div id="seiwp-piechart-1'+b+'" class="halfsize floatleft"></div>';k+='<div id="seiwp-piechart-2'+b+'" class="halfsize floatright"></div>';k+="</div>";k+='<div class="seiwp-floatwraper">';k+='<div id="seiwp-piechart-3'+b+'" class="halfsize floatleft"></div>';k+='<div id="seiwp-piechart-4'+b+'" class="halfsize floatright"></div>';k+="</div>";k+="</div>";if(!jQuery("#seiwp-orgchartpiecharts"+b).length){jQuery("#seiwp-reports"+b).html(k)}e.orgChartPieChartsData=j;if(jQuery.isArray(j)){if(!jQuery.isNumeric(j[0])){if(jQuery.isArray(j[0])){e.drawOrgChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#seiwp-orgchart"+b,j[0],"125px")}for(l=1;l<j.length;l++){if(!jQuery.isNumeric(j[l])){if(jQuery.isArray(j[l])){e.drawPieChart("piechart-"+l,j[l],e.i18n[l])}else{e.throwDebug(j[l])}}else{e.throwError("#seiwp-piechart-"+l+b,j[l],"80px")}}}else{e.throwDebug(j)}SEIWPNProgress.done()},geoChartTableChart:function(j){var k;k='<div id="seiwp-geocharttablechart'+b+'">';k+='<div id="seiwp-geochart'+b+'"></div>';k+='<div id="seiwp-dashboard'+b+'">';k+='<div id="seiwp-control'+b+'"></div>';k+='<div id="seiwp-tablechart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#seiwp-geocharttablechart"+b).length){jQuery("#seiwp-reports"+b).html(k)}e.geoChartTableChartData=j;if(jQuery.isArray(j)){if(!jQuery.isNumeric(j[0])){if(jQuery.isArray(j[0])){e.drawGeoChart(j[0]);e.drawTableChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#seiwp-geochart"+b,j[0],"125px");e.throwError("#seiwp-tablechart"+b,j[0],"125px")}}else{e.throwDebug(j)}SEIWPNProgress.done()},orgChartTableChart:function(j){var k;k='<div id="seiwp-orgcharttablechart'+b+'">';k+='<div id="seiwp-orgchart'+b+'"></div>';k+='<div id="seiwp-dashboard'+b+'">';k+='<div id="seiwp-control'+b+'"></div>';k+='<div id="seiwp-tablechart'+b+'"></div>';k+="</div>";k+="</div>";if(!jQuery("#seiwp-orgcharttablechart"+b).length){jQuery("#seiwp-reports"+b).html(k)}e.orgChartTableChartData=j;if(jQuery.isArray(j)){if(!jQuery.isNumeric(j[0])){if(jQuery.isArray(j[0])){e.drawOrgChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#seiwp-orgchart"+b,j[0],"125px")}if(!jQuery.isNumeric(j[1])){if(jQuery.isArray(j[1])){e.drawTableChart(j[1])}else{e.throwDebug(j[1])}}else{e.throwError("#seiwp-tablechart"+b,j[1],"125px")}}else{e.throwDebug(j)}SEIWPNProgress.done()},tableChart:function(j){var k;k='<div id="seiwp-404tablechart'+b+'">';k+='<div id="seiwp-tablechart'+b+'"></div>';k+="</div>";if(!jQuery("#seiwp-404tablechart"+b).length){jQuery("#seiwp-reports"+b).html(k)}e.tableChartData=j;if(jQuery.isArray(j)){if(!jQuery.isNumeric(j[0])){if(jQuery.isArray(j[0])){e.drawTableChart(j[0])}else{e.throwDebug(j[0])}}else{e.throwError("#seiwp-tablechart"+b,j[0],"125px")}}else{e.throwDebug(j)}SEIWPNProgress.done()},drawTableChart:function(o){var n,k,m,l,j,p,q;if(c=="position"){l=true}else{l=false}n=google.visualization.arrayToDataTable(o);k={page:"enable",pageSize:10,width:"100%",allowHtml:true,sortColumn:1,sortAscending:l};j=new google.visualization.Dashboard(document.getElementById("seiwp-dashboard"+b));p=new google.visualization.ControlWrapper({controlType:"StringFilter",containerId:"seiwp-control"+b,options:{filterColumnIndex:0,matchType:"any",ui:{label:"",cssClass:"seiwp-dashboard-control"}}});google.visualization.events.addListener(p,"ready",function(){jQuery(".seiwp-dashboard-control input").prop("placeholder",seiwpItemData.i18n[1])});q=new google.visualization.ChartWrapper({chartType:"Table",containerId:"seiwp-tablechart"+b,options:k});j.bind(p,q);j.draw(n);google.visualization.events.addListener(q,"select",function(){console.log(q.getDataTable().getValue(q.getChart().getSelection()[0].row,0))})},drawOrgChart:function(m){var l,j,k;l=google.visualization.arrayToDataTable(m);j={allowCollapse:true,allowHtml:true,height:"100%",nodeClass:"seiwp-orgchart",selectedNodeClass:"seiwp-orgchart-selected"};k=new google.visualization.OrgChart(document.getElementById("seiwp-orgchart"+b));k.draw(l,j)},drawPieChart:function(o,m,n){var l,j,k;l=google.visualization.arrayToDataTable(m);j={is3D:false,tooltipText:"percentage",legend:"none",chartArea:{width:"99%",height:"80%"},title:n,pieSliceText:"value",colors:seiwpItemData.colorVariations};k=new google.visualization.PieChart(document.getElementById("seiwp-"+o+b));k.draw(l,j)},drawGeoChart:function(m){var l,j,k;l=google.visualization.arrayToDataTable(m);j={chartArea:{width:"99%",height:"90%"},colors:[seiwpItemData.colorVariations[5],seiwpItemData.colorVariations[4]]};k=new google.visualization.GeoChart(document.getElementById("seiwp-geochart"+b));k.draw(l,j)},drawareachart:function(n,o){var m,j,l,k;m=google.visualization.arrayToDataTable(n);if(o){k=new google.visualization.NumberFormat({suffix:"%",fractionDigits:2});k.format(m,1)}j={legend:{position:"none"},pointSize:1.2,colors:[seiwpItemData.colorVariations[0],seiwpItemData.colorVariations[4]],areaOpacity:0.9,chartArea:{width:"99%",height:"90%"},vAxis:{textPosition:"in",minValue:0,textStyle:{auraColor:"white",color:"black"}},hAxis:{textPosition:"none"},curveType:"function"};l=new google.visualization.AreaChart(document.getElementById("seiwp-areachart"+b));l.draw(m,j)},drawSummary:function(j){jQuery("#seiwpimpressions"+b).html(j[0]);jQuery("#seiwpclicks"+b).html(j[1]);jQuery("#seiwpposition"+b).html(j[2]);jQuery("#seiwpctr"+b).html(j[3]);jQuery("#seiwpservererrors"+b).html(j[5]);jQuery("#seiwpnotfound"+b).html(j[4])},throwDebug:function(j){jQuery("#seiwp-status"+b).css({"margin-top":"3px","padding-left":"5px",height:"auto",color:"#000","border-left":"5px solid red"});if(j=="-24"){jQuery("#seiwp-status"+b).html(seiwpItemData.i18n[15])}else{jQuery("#seiwp-reports"+b).css({"background-color":"#F7F7F7",height:"auto","margin-top":"10px","padding-top":"50px","padding-bottom":"50px",color:"#000","text-align":"center"});jQuery("#seiwp-reports"+b).html(j);jQuery("#seiwp-reports"+b).show();jQuery("#seiwp-status"+b).html(seiwpItemData.i18n[11]);console.log("\n********************* SEIWP Log ********************* \n\n"+j);a={action:"seiwp_set_error",response:j,seiwp_security_set_error:seiwpItemData.security};jQuery.post(seiwpItemData.ajaxurl,a)}},throwError:function(l,j,k){jQuery(l).css({"background-color":"#F7F7F7",height:"auto","padding-top":k,"padding-bottom":k,color:"#000","text-align":"center"});if(j==-21){jQuery(l).html('<p><span style="font-size:4em;color:#778899;margin-left:-20px;" class="dashicons dashicons-clock"></span></p><br><p style="font-size:1.1em;color:#778899;">'+seiwpItemData.i18n[12]+"</p>")}else{jQuery(l).html(seiwpItemData.i18n[13]+" ("+j+")")}},render:function(p,m,n){var l,q,r,k,o;jQuery("#seiwp-sel-report"+b).show();jQuery("#seiwp-status"+b).html("");if(m){q=m.split(" - ")[0];r=m.split(" - ")[1]}else{var j=new Date();j.setDate(j.getDate()-30);q=j.toISOString().split("T")[0];j=new Date();r=j.toISOString().split("T")[0]}d.setCookie("default_metric",n);if(m){d.setCookie("default_dimension",m)}if(typeof p!=="undefined"){d.setCookie("default_view",p);l=p}else{l=false}if(seiwpItemData.scope=="admin-item"){a={action:"seiwp_backend_item_reports",seiwp_security_backend_item_reports:seiwpItemData.security,from:q,to:r,filter:g}}else{if(seiwpItemData.scope=="front-item"){a={action:"seiwp_frontend_item_reports",seiwp_security_frontend_item_reports:seiwpItemData.security,from:q,to:r,filter:seiwpItemData.filter}}else{a={action:"seiwp_backend_item_reports",seiwp_security_backend_item_reports:seiwpItemData.security,projectId:l,from:q,to:r}}}if(jQuery.inArray(n,["pages","keywords"])>-1){jQuery("#seiwp-sel-metric"+b).show();a.query="channelGrouping,"+n;a.metric=c;jQuery.post(seiwpItemData.ajaxurl,a,function(s){e.orgChartTableChart(s)})}else{if(n=="404errors"){jQuery("#seiwp-sel-metric"+b).show();a.query=n;a.metric=c;jQuery.post(seiwpItemData.ajaxurl,a,function(s){e.tableChart(s)})}else{if(n=="siteperformance"||n=="technologydetails"){jQuery("#seiwp-sel-metric"+b).show();if(n=="siteperformance"){a.query="channelGrouping,medium,visitorType,source,socialNetwork";e.i18n=seiwpItemData.i18n.slice(0,5)}else{e.i18n=seiwpItemData.i18n.slice(15,20);a.query="deviceCategory,browser,operatingSystem,screenResolution,mobileDeviceBranding"}a.metric=c;jQuery.post(seiwpItemData.ajaxurl,a,function(s){e.orgChartPieCharts(s)})}else{if(n=="locations"){jQuery("#seiwp-sel-metric"+b).show();a.query=n;a.metric=c;jQuery.post(seiwpItemData.ajaxurl,a,function(s){e.geoChartTableChart(s)})}else{a.query=n+",summary";jQuery.post(seiwpItemData.ajaxurl,a,function(s){e.areachartSummary(s)})}}}}},refresh:function(){if(jQuery("#seiwp-areachartsummary"+b).length>0&&jQuery.isArray(e.areachartSummaryData)){e.areachartSummary(e.areachartSummaryData)}if(jQuery("#seiwp-orgchartpiecharts"+b).length>0&&jQuery.isArray(e.orgChartPieChartsData)){e.orgChartPieCharts(e.orgChartPieChartsData)}if(jQuery("#seiwp-geocharttablechart"+b).length>0&&jQuery.isArray(e.geoChartTableChartData)){e.geoChartTableChart(e.geoChartTableChartData)}if(jQuery("#seiwp-orgcharttablechart"+b).length>0&&jQuery.isArray(e.orgChartTableChartData)){e.orgChartTableChart(e.orgChartTableChartData)}if(jQuery("#seiwp-404tablechart"+b).length>0&&jQuery.isArray(e.tableChartData)){e.tableChart(e.tableChartData)}},init:function(){try{SEIWPNProgress.configure({parent:"#seiwp-progressbar"+b,showSpinner:false});SEIWPNProgress.start()}catch(j){e.alertMessage(seiwpItemData.i18n[0])}e.render(jQuery("#seiwp-sel-property"+b).val(),jQuery('input[name="seiwp-sel-period'+b+'"]').val(),jQuery("#seiwp-sel-report"+b).val());jQuery(window).resize(function(){var k=jQuery(window).width()-e.oldViewPort;if((k<-5)||(k>5)){e.oldViewPort=jQuery(window).width();e.refresh()}})}};h.init();e.init();jQuery("#seiwp-sel-property"+b).change(function(){e.init()});jQuery(function(){jQuery('input[name="seiwp-sel-period'+b+'"]').daterangepicker({ranges:{"Last 7 Days":[moment().subtract(6,"days"),moment()],"Last 30 Days":[moment().subtract(29,"days"),moment()],"Last 90 Days":[moment().subtract(89,"days"),moment()],"This Month":[moment().startOf("month"),moment().endOf("month")],"Last Month":[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")]},minDate:moment().subtract(16,"months"),maxDate:moment(),autoUpdateInput:true,locale:{format:"YYYY-MM-DD"}})});jQuery('input[name="seiwp-sel-period'+b+'"]').change(function(){e.init()});jQuery("#seiwp-sel-report"+b).change(function(){e.init()});jQuery("[id^=seiwp-swmetric-]").click(function(){c=this.id.replace("seiwp-swmetric-","");d.setCookie("default_swmetric",c);jQuery("#seiwp-swmetric-impressions").css("color","#444");jQuery("#seiwp-swmetric-position").css("color","#444");jQuery("#seiwp-swmetric-clicks").css("color","#444");jQuery("#seiwp-swmetric-ctr").css("color","#444");jQuery("#"+this.id).css("color","#008ec2");e.init()});if(seiwpItemData.scope=="admin-widgets"){return}else{return this.dialog({width:"auto",maxWidth:510,height:"auto",modal:true,fluid:true,dialogClass:"seiwp wp-dialog",resizable:false,title:e.getTitle(seiwpItemData.scope),position:{my:"top",at:"top+100",of:window}})}}});function SEIWPReportLoad(){if(seiwpItemData.scope=="admin-widgets"){jQuery("#seiwp-window-1").seiwpItemReport(1)}else{if(seiwpItemData.scope=="front-item"){jQuery(seiwpItemData.getSelector(seiwpItemData.scope)).click(function(){if(!jQuery("#seiwp-window-1").length>0){jQuery("body").append('<div id="seiwp-window-1"></div>')}jQuery("#seiwp-window-1").seiwpItemReport(1)})}else{jQuery(seiwpItemData.getSelector(seiwpItemData.scope)).click(function(){if(!jQuery("#seiwp-window-"+seiwpItemData.getID(this)).length>0){jQuery("body").append('<div id="seiwp-window-'+seiwpItemData.getID(this)+'"></div>')}jQuery("#seiwp-window-"+seiwpItemData.getID(this)).seiwpItemReport(seiwpItemData.getID(this))})}}jQuery(window).resize(function(){seiwpItemData.responsiveDialog()});jQuery(document).on("dialogopen",".ui-dialog",function(a,b){seiwpItemData.responsiveDialog()})};